<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Assignment Connect - Connect Individuals to Assign</title>
    <meta name="csrf-param" content="_csrf">
<meta name="csrf-token" content="X3jbUpS5iXvCXrssWGDX7YpbB-ZXHlEbxl8q8i-MlAJoN5gLwvbdFpVr4WVuVYGO2GMwhCRXOESwMkSiRNPwWg==">

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<meta name="keywords" content="">
<link type="image/x-icon" href="/tutor-expert/favicon.ico" rel="icon">
<link href="/tutor-expert/assets/c966ad09/dist/css/bootstrap.css" rel="stylesheet">
<link href="/tutor-expert/css/site.css" rel="stylesheet">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="assets/custom/css/style.css">
    <link rel="stylesheet" href="assets/custom/css/login-modal.css">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<body class="">
    
    
    
    <header class="main-header">
    <nav class="navbar navbar-expand-lg">
        <div class="container">
            <!-- Logo -->
            <a class="navbar-brand" href="index.php">
                <img src="assets/custom/images/logo.png" alt="Assignment By Teachers Logo" class="logo">
            </a>
            <!-- Hamburger Menu Button -->
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarMain" aria-controls="navbarMain" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <!-- Collapsible Navbar Content -->
            <div class="collapse navbar-collapse" id="navbarMain">
                <!-- Main Navigation Links -->
                <ul class="navbar-nav" style="margin-left:4rem;">
                    <li class="nav-item">
                        <a class="nav-link active" href="index.php">Home</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="subjectsDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            Subjects
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="subjectsDropdown">
                            <li><a class="dropdown-item" href="#">Mathematics</a></li>
                            <li><a class="dropdown-item" href="#">Science</a></li>
                            <li><a class="dropdown-item" href="#">English</a></li>
                            <li><a class="dropdown-item" href="#">History</a></li>
                        </ul>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="tutorDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            Tutor
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="tutorDropdown">
                            <li><a class="dropdown-item" href="#">Find a Tutor</a></li>
                            <li><a class="dropdown-item" href="#">Become a Tutor</a></li>
                            <li><a class="dropdown-item" href="#">Request a Tutor</a></li>
                        </ul>
                    </li>
                </ul>
                <!-- Login Button -->



                <ul class="navbar-nav">
                    <li class="nav-item">
                        <div class="auth">
                            <div class="dropdown">
                    
                        
                        <a class="btn btn-primary w-100 dropdown-toggle" href="#" id="menuDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" >Shoaib (<small class="text-white">student</small>)</a>
                    
                    <ul class="dropdown-menu w-100" aria-labelledby="menuDropdown" >
                                                    <li><a class="dropdown-item" href="http://localhost/tutor-expert/profile">Profile</a></li>
                            <li><a class="dropdown-item" href="http://localhost/tutor-expert/profile/edit">Edit Profile</a></li>
                            <li><a class="dropdown-item" href="http://localhost/tutor-expert/peoples">Peoples & Messages</a></li>
                            <li><a class="dropdown-item" href="http://localhost/tutor-expert/post/list">Post</a></li>
                            <li><a class="dropdown-item" href="http://localhost/tutor-expert/post/create">Create</a></li>
                                                <li>
                        <form action="/tutor-expert/logout" method="post">
<input type="hidden" name="_csrf" value="X3jbUpS5iXvCXrssWGDX7YpbB-ZXHlEbxl8q8i-MlAJoN5gLwvbdFpVr4WVuVYGO2GMwhCRXOESwMkSiRNPwWg=="><button type="submit" class="btn btn-link dropdown-item logout">Logout</button></form>                        </li>
                    </ul>
                </div>
                    </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>
<style>
    @media (max-width: 991px) {
        #navbarMain {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
    }
</style>
    
<style>
    .messaging-main-container {
        margin: 40px auto;
        /* background: #fff;
        border-radius: 16px;
        box-shadow: 0 4px 24px rgba(0,0,0,0.08); */
        padding: 0;
        overflow: hidden;
        asd
    }

    .messaging-header {
        background: #564FFD;
        padding: 24px 32px 16px 32px;
        border-bottom: 1px solid #eaeaea;
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    .messaging-header h2 {
        font-size: 1.5rem;
        font-weight: 700;
        color: white;
        margin: 0;
    }

    .chat-container 
        display: flex;
        height: 600px;
        gap: 0;
        padding: 0;
        /* background: #f8fafc; */
        background: transparent;
    }

    .users-sidebar {
        width: 270px;
        background: #f5f5f5;
        border-right: 1px solid #eaeaea;
        padding: 0;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
    }

    .users-sidebar h4 {
        padding: 18px 24px 8px 24px;
        margin: 0;
        font-size: 1.1rem;
        font-weight: 600;
        color: #09B31A;
        border-bottom: 1px solid #eaeaea;
    }

    .users-list {
        flex: 1;
        padding: 8px 0 8px 0;
        overflow-y: auto;
    }

    .user-item {
        padding: 12px 24px;
        margin-bottom: 2px;
        background: #fff;
        /* border-radius: 0 20px 20px 0; */
        cursor: pointer;
        font-size: 1rem;
        color: #333;
        transition: background 0.15s, color 0.15s;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .user-item:hover, .user-item.active {
        background:#564FFD;
        color: white;
    }

    .chat-screen {
        flex: 1;
        display: flex;
        flex-direction: column;
        border: none;
        border-radius: 24px;
        background: #fff;
        margin: 24px 0 24px 0;
        box-shadow: 0 4px 24px rgba(0,0,0,0.08);
        min-width: 0;
    }

    .chat-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 32px 40px 16px 40px;
        background: #fff;
        border-radius: 24px 24px 0 0;
    }

    .chat-header-left {
        display: flex;
        align-items: center;
        gap: 18px;
    }

    .chat-header-avatar {
        width: 64px;
        height: 64px;
        border-radius: 50%;
        object-fit: cover;
        background: #eee;
        border: 2px solid #f5f5f7;
    }

    .chat-header-info {
        display: flex;
        flex-direction: column;
        justify-content: center;
    }

    .chat-header-username {
        font-size: 1.35rem;
        font-weight: 700;
        color: #222;
        margin-bottom: 2px;
    }

    .chat-header-status {
        font-size: 1rem;
        color: #888;
        font-weight: 400;
    }

    .chat-header-right {
        display: flex;
        align-items: center;
        gap: 24px;
    }

    .chat-header-icon {
        font-size: 1.45rem;
        color: #bbb;
        cursor: pointer;
        transition: color 0.15s;
        background: none;
        border: none;
        padding: 0;
    }

    .chat-header-icon:hover {
        color: #564FFD;
    }

    .chat-header-divider {
        border-bottom: 1px solid #eee;
        margin: 0 40px;
    }

    .chat-messages {
        flex: 1;
        overflow-y: auto;
        padding: 32px 40px 24px 40px;
        background: #fff;
        display: flex;
        flex-direction: column;
        gap: 18px;
    }

    .chat-bubble {
        max-width: 60%;
        padding: 16px 22px;
        border-radius: 22px 22px 22px 6px;
        font-size: 1.08rem;
        margin-bottom: 2px;
        word-break: break-word;
        box-shadow: 0 2px 8px rgba(46,204,113,0.04);
        position: relative;
        display: inline-block;
    }

    .chat-bubble-incoming {
        background: #f5f5f7;
        color: #222;
        align-self: flex-start;
        border-radius: 22px 22px 6px 22px;
    }

    .chat-bubble-outgoing {
        background: #6C63FF;
        color: #fff;
        align-self: flex-end;
        border-radius: 22px 22px 22px 6px;
    }

    .chat-bubble-timestamp {
        font-size: 0.92rem;
        color: #aaa;
        margin-top: 4px;
        margin-bottom: 2px;
        display: block;
        text-align: right;
    }

    .chat-bubble-incoming .chat-bubble-timestamp {
        text-align: left;
    }

    .message-input-bar {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 18px 32px;
        background: #f5f5f7;
        border-radius: 0 0 24px 24px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.03);
        margin-top: 0;
    }

    .input-attach-icon {
        font-size: 1.4rem;
        color: #bbb;
        cursor: pointer;
        margin-right: 8px;
        background: none;
        border: none;
        padding: 0;
    }

    .input-text {
        flex: 1;
        padding: 14px 18px;
        border: none;
        border-radius: 18px;
        font-size: 1.08rem;
        background: #fff;
        outline: none;
        margin: 0 8px;
    }

    .input-action-icons {
        display: flex;
        align-items: center;
        gap: 14px;
    }

    .input-action-icon {
        font-size: 1.4rem;
        color: #bbb;
        cursor: pointer;
        background: none;
        border: none;
        padding: 0;
        transition: color 0.15s;
    }

    .input-action-icon:hover {
        color: #564FFD;
    }

    .no-chat {
        padding: 60px 0;
        text-align: center;
        color: #aaa;
        font-size: 1.2rem;
    }

    @media (max-width: 900px) {
        .messaging-main-container { padding: 0; }
        .chat-container { flex-direction: column; height: auto; }
        .users-sidebar { width: 100%; border-right: none; border-bottom: 1px solid #eaeaea; }
        .chat-screen { min-height: 400px; }
    }
    a{
    text-decoration: none;
}

    /* --- Sidebar Redesign --- */
    .sidebar-container {
        background: #fff;
        border-radius: 24px;
        box-shadow: 0 4px 24px rgba(0,0,0,0.08);
        padding: 24px 0 0 0;
        margin: 24px 0 24px 0;
        width: 340px;
        min-width: 300px;
        display: flex;
        flex-direction: column;
        height: 100%;
    }
    .sidebar-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 32px 8px 32px;
    }
    .sidebar-header h2 {
        font-size: 1.35rem;
        font-weight: 700;
        color: #222;
        margin: 0;
    }
    .sidebar-header .sidebar-menu {
        font-size: 1.5rem;
        color: #444;
        cursor: pointer;
        border: none;
        background: none;
        padding: 0;
    }
    .sidebar-search {
        padding: 0 24px 16px 24px;
    }
    .sidebar-search input {
        width: 100%;
        padding: 12px 18px;
        border-radius: 24px;
        border: none;
        background: #f5f5f7;
        font-size: 1rem;
        box-shadow: 0 2px 8px rgba(0,0,0,0.03);
        outline: none;
        margin-bottom: 0;
    }
    .sidebar-people-title {
        font-size: 1.1rem;
        font-weight: 600;
        color: #222;
        padding: 0 24px 8px 24px;
        margin: 0 0 0.5rem 0;
    }
    .sidebar-users-list {
        flex: 1;
        overflow-y: auto;
        padding: 0 0 8px 0;
    }
    .sidebar-user-item {
        display: flex;
        align-items: center;
        padding: 12px 24px;
        cursor: pointer;
        transition: background 0.15s, color 0.15s;
        border-radius: 16px;
        margin: 0 8px 2px 8px;
        position: relative;
        background: #fff;
    }
    .sidebar-user-item:hover, .sidebar-user-item.active {
        background: #f0f0ff;
    }
    .sidebar-user-avatar {
        width: 44px;
        height: 44px;
        border-radius: 50%;
        object-fit: cover;
        margin-right: 14px;
        border: 2px solid #f5f5f7;
        background: #eee;
    }
    .sidebar-user-info {
        flex: 1;
        min-width: 0;
        display: flex;
        flex-direction: column;
    }
    .sidebar-user-top {
        display: flex;
        align-items: center;
        justify-content: space-between;
    }
    .sidebar-user-name {
        font-weight: 600;
        font-size: 1rem;
        color: #222;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        max-width: 120px;
    }
    .sidebar-user-time {
        font-size: 0.85rem;
        color: #aaa;
        margin-left: 8px;
        white-space: nowrap;
    }
    .sidebar-user-bottom {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-top: 2px;
    }
    .sidebar-user-preview {
        font-size: 0.97rem;
        color: #888;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        max-width: 140px;
    }
    .sidebar-user-badges {
        display: flex;
        align-items: center;
        gap: 4px;
    }
    .sidebar-user-unread {
        background: #ff2d55;
        color: #fff;
        border-radius: 50%;
        font-size: 0.85rem;
        font-weight: 600;
        min-width: 22px;
        height: 22px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-left: 4px;
    }
    .sidebar-user-tick {
        color: #564FFD;
        font-size: 1.1rem;
        margin-left: 4px;
    }
    @media (max-width: 900px) {
        .sidebar-container { width: 100%; min-width: 0; margin: 0 0 16px 0; }
    }
</style>

<div class="messaging-main-container container">
    <div class="chat-container">
        <!-- Left Sidebar for Users -->
        <div class="sidebar-container">
            <div class="sidebar-header">
                <h2>Messages</h2>
                <button class="sidebar-menu"><i class="fa fa-ellipsis-h"></i></button>
            </div>
            <div class="sidebar-search">
                <input type="text" placeholder="Search">
            </div>
            <div class="sidebar-people-title">People</div>
            <div class="sidebar-users-list">
                                <a href="http://localhost/tutor-expert/peoples/chat?other=7" style="text-decoration:none;">
                    <div class="sidebar-user-item active">
                        <img class="sidebar-user-avatar" src="http://localhost/tutor-expert/_assets/custom/images/avatars/avatar-1.png" alt="avatar">
                        <div class="sidebar-user-info">
                            <div class="sidebar-user-top">
                                <span class="sidebar-user-name">Shoaib Shokat</span>
                                <span class="sidebar-user-time">Today, 9.52pm</span>
                            </div>
                            <div class="sidebar-user-bottom">
                                <span class="sidebar-user-preview">Message preview...</span>
                                <span class="sidebar-user-badges">
                                                                            <i class="fa fa-check-double sidebar-user-tick"></i>
                                                                                                                <span class="sidebar-user-unread">3</span>
                                                                    </span>
                            </div>
                        </div>
                    </div>
                </a>
                            </div>
        </div>
        <!-- Right Chat Screen -->
        <div class="chat-screen">
            <!-- Chat Header -->
            <div class="chat-header">
                <div class="chat-header-left">
                    <img class="chat-header-avatar" src="http://localhost/tutor-expert/_assets/custom/images/avatars/avatar-1.png" alt="avatar">
                    <div class="chat-header-info">
                        <span class="chat-header-username">Shoaib Shokat</span>
                        <span class="chat-header-status">Online - Last seen, 2.02pm</span>
                    </div>
                </div>
                <div class="chat-header-right">
                    <button class="chat-header-icon"><i class="fa fa-phone"></i></button>
                    <button class="chat-header-icon"><i class="fa fa-video-camera"></i></button>
                    <button class="chat-header-icon"><i class="fa fa-ellipsis-h"></i></button>
                </div>
            </div>
            <div class="chat-header-divider"></div>
            <!-- Chat Messages -->
            <div class="chat-messages" id="chatMessages">
                <!-- Messages will be displayed here -->
            </div>
            <!-- Message Input Bar -->
            <form class="message-input-bar" id="messageForm">
                <button type="button" class="input-attach-icon"><i class="fa fa-paperclip"></i></button>
                <input type="text" id="messageText" class="input-text" placeholder="Type your message here...">
                <div class="input-action-icons">
                    <button type="button" class="input-action-icon"><i class="fa fa-smile-o"></i></button>
                    <button type="button" class="input-action-icon"><i class="fa fa-camera"></i></button>
                    <button type="submit" class="input-action-icon"><i class="fa fa-microphone"></i></button>
                </div>
            </form>
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>

<script>
    const secretkeyForEncryption = "random1000secret1000keys";
    // Function to encrypt text
    function encryptText(text, secretKey) {
        return CryptoJS.AES.encrypt(text, secretKey).toString();
    }

    // Function to decrypt text
    function decryptText(encryptedText, secretKey) {
        let bytes = CryptoJS.AES.decrypt(encryptedText, secretKey);
        return bytes.toString(CryptoJS.enc.Utf8);
    }

    function toggleSound(soundButton) {
        const isSoundOn = sessionStorage.getItem("messageSound") === "true";

        if (isSoundOn) {
            soundButton.innerHTML = `<i class="fas fa-volume-high"></i>`;
            soundButton.classList.remove("sound-off");
        } else {
            soundButton.innerHTML = `<i class="fas fa-volume-xmark"></i>`;
            soundButton.classList.add("sound-off");
        }
    }

    const soundButton = document.querySelector("#soundButton");

    if (!sessionStorage.getItem("messageSound")) {
        sessionStorage.setItem("messageSound", "true");
    }

    if (soundButton) {
        toggleSound(soundButton);

        soundButton.addEventListener("click", () => {
            const currentState = sessionStorage.getItem("messageSound") === "true";
            sessionStorage.setItem("messageSound", !currentState);
            toggleSound(soundButton);
        });
    }

    const baseUrl = "http://localhost/tutor-expert/";
    const myId = "2";
    const myName = "Shoaib";
    const otherId = "7";

    function SSE_EVENT(params) {
        // Connect to the SSE endpoint
        const eventSource = new EventSource(`${baseUrl}sse/chat?myId=${myId}&otherId=${otherId}`); // Replace with actual IDs
        eventSource.onmessage = function(event) {
            console.log(event)
            const data = JSON.parse(event.data);
            console.log(data)
            addMessage(data);
        };

        eventSource.onerror = function(event) {
            // console.error("Error occurred:", event);
        };
    }
    SSE_EVENT();

    function addMessage(data) {
        const messagesDiv = document.getElementById('chatMessages');
        const isIncoming = data.sender_id == otherId;
        const bubbleClass = isIncoming ? 'chat-bubble chat-bubble-incoming' : 'chat-bubble chat-bubble-outgoing';
        const timeClass = isIncoming ? 'chat-bubble-timestamp' : 'chat-bubble-timestamp';
        messagesDiv.insertAdjacentHTML('beforeend', `
            <div class="${bubbleClass}">
                <div>${decryptText(data.message,secretkeyForEncryption)}</div>
                <span class="${timeClass}">${data.created_at}</span>
            </div>
        `);
        messagesDiv.scrollTop = messagesDiv.scrollHeight;
        if (sessionStorage.getItem("messageSound") == "true" && isIncoming) {
            const messageSound = new Audio(`${baseUrl}assets/audios/notification.mp3`);
            messageSound.play();
        }
    }

    const sendMessage = async (senderId, receiverId, message, job_post_id) => {
        const response = await fetch(`${baseUrl}api/add-message`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                job_post_id: job_post_id,
                sender_id: senderId,
                receiver_id: receiverId,
                message: message,
            }),
        });

        const result = await response.json();
        if (result.success) {
            console.log('Message sent:', result.data);
        } else {
            console.error('Error:', result.message, result.errors);
        }
    };

    function showMessages() {
        fetch(`${baseUrl}api/messages?other=${otherId}`)
            .then(r => r.json())
            .then(d => {
                const messages = d.messages;
                const messagesDiv = document.getElementById('chatMessages');
                messages.map(data => {
                    const isIncoming = data.message.sender_id == otherId;
                    const bubbleClass = isIncoming ? 'chat-bubble chat-bubble-incoming' : 'chat-bubble chat-bubble-outgoing';
                    const timeClass = isIncoming ? 'chat-bubble-timestamp' : 'chat-bubble-timestamp';
                    messagesDiv.insertAdjacentHTML('beforeend', `
                        <div class="${bubbleClass}">
                            <div>${decryptText(data.message.message,secretkeyForEncryption)}</div>
                            <span class="${timeClass}">${data.message.created_at}</span>
                        </div>
                    `);
                    messagesDiv.scrollTop = messagesDiv.scrollHeight;
                });
            })
    }
    showMessages();

    function getFormatedTime() {
        const currentDate = new Date();

        // Format the date components
        const year = currentDate.getFullYear();
        const month = String(currentDate.getMonth() + 1).padStart(2, '0'); // Months are 0-based, so add 1
        const day = String(currentDate.getDate()).padStart(2, '0');

        // Format the time components
        const hours = String(currentDate.getHours()).padStart(2, '0');
        const minutes = String(currentDate.getMinutes()).padStart(2, '0');
        const seconds = String(currentDate.getSeconds()).padStart(2, '0');

        // Combine into the desired format
        const formattedDateTime = `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
        return formattedDateTime;
    }

    const postID = "";
    if (parseInt(postID) > 0) {
        const postTitle = "I am interested for : "
        const encText = encryptText(postTitle, secretkeyForEncryption);
        const data = {
            job_post_id: postID,
            sender_id: myId,
            sender: myName,
            created_at: getFormatedTime(),
            message: encText,
        };
        // addMessage(data);
        sendMessage(myId, otherId, encText, job_post_id = postID);
        removeURLParameter('post');
    }

    function removeURLParameter(parameter) {
        let url = new URL(window.location.href);
        url.searchParams.delete(parameter);
        window.history.replaceState(null, null, url.toString());
    }

    const messagForm = document.querySelector("#messageForm");
    if (messagForm) {
        messagForm.addEventListener("submit", (event) => {
            event.preventDefault();
            const messageInput = document.querySelector("#messageText");
            if (messageInput.value.length > 0) {
                const encText = encryptText(messageInput.value, secretkeyForEncryption);
                const data = {
                    job_post_id: null,
                    sender_id: myId,
                    sender: myName,
                    created_at: getFormatedTime(),
                    message: encText,
                };
                addMessage(data);
                sendMessage(myId, otherId, encText, job_post_id = 0);
                messagForm.reset();
            }
        })
    }
</script>
    <footer class="main-footer bg-dark text-light py-5">
    <div class="container">
        <div class="row justify-content-between">
            <div class="col-lg-2 col-md-6 mb-4 mb-lg-0">
                <img src="http://localhost/tutor-expert/assets/custom/images/logo-white.png" alt="Assignment Connect" class="footer-logo mb-4">
                <p>Connecting educational institutions with expert tutors worldwide.</p>
                <div class="social-links">
                    <a href="#" class="social-icon-link"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" class="social-icon-link"><i class="fab fa-instagram"></i></a>
                    <a href="#" class="social-icon-link linkedin"><i class="fab fa-linkedin-in"></i></a>
                    <a href="#" class="social-icon-link"><i class="fab fa-twitter"></i></a>
                    <a href="#" class="social-icon-link"><i class="fab fa-youtube"></i></a>
                </div>
            </div>
            
            <div class="col-lg-2 col-md-6 mb-4 mb-lg-0">
                <h4>TOP 4 CATEGORY</h4>
                <ul class="list-unstyled">
                    <li><a href="#">Development</a></li>
                    <li><a href="#">Finance & Accounting</a></li>
                    <li><a href="#">Design</a></li>
                    <li><a href="#">Business</a></li>
                </ul>
            </div>
            
            <div class="col-lg-2 col-md-6 mb-4 mb-lg-0">
                <h4>Quick Links</h4>
                <ul class="list-unstyled">
                    <li><a href="#">About</a></li>
                    <li><a href="#" class="become-instructor">Become Instructor â†’</a></li>
                    <li><a href="#">Contact</a></li>
                    <li><a href="#">Career</a></li>
                </ul>
            </div>

            <div class="col-lg-2 col-md-6 mb-4 mb-lg-0">
                <h4>Support</h4>
                <ul class="list-unstyled">
                    <li><a href="#">Help Center</a></li>
                    <li><a href="#">FAQs</a></li>
                    <li><a href="#">Terms & Condition</a></li>
                    <li><a href="#">Privacy Policy</a></li>
                </ul>
            </div>
            
            <div class="col-lg-2 col-md-6">
                <h4>Download Our App</h4>
                <div class="app-buttons">
                    <a href="#" class="d-block mb-2">
                        <img src="http://localhost/tutor-expert/assets/custom/images/app-store.png" alt="App Store" class="img-fluid">
                    </a>
                    <a href="#" class="d-block">
                        <img src="http://localhost/tutor-expert/assets/custom/images/google-play.png" alt="Google Play" class="img-fluid">
                    </a>
                </div>
            </div>
        </div>
        
        <div class="row mt-5">
            <div class="col-12">
                <div class="footer-bottom d-flex justify-content-between">
                    <p class="mb-0">&copy; 2025 Assignment Connect. All rights reserved.</p>
                    <div class="language-selector">
                        <select class="form-select bg-dark text-light border-0">
                            <option selected>English</option>
                            <option>Spanish</option>
                            <option>French</option>
                            <option>German</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>

<script>
    // Social icon hover functionality
    document.addEventListener('DOMContentLoaded', function() {
        const socialIcons = document.querySelectorAll('.social-icon-link');
        
        // Set default active state to LinkedIn (middle icon)
        const linkedInIcon = document.querySelector('.social-icon-link.linkedin');
        
        socialIcons.forEach(icon => {
            icon.addEventListener('mouseenter', function() {
                // Remove active class from all icons
                socialIcons.forEach(i => i.classList.remove('linkedin'));
                // Add active class to hovered icon
                this.classList.add('linkedin');
            });
            
            icon.addEventListener('mouseleave', function() {
                // Remove active class from all icons
                socialIcons.forEach(i => i.classList.remove('linkedin'));
                // Reset default active state
                linkedInIcon.classList.add('linkedin');
            });
        });
    });
</script>     

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="assets/custom/js/main.js"></script>
    <script src="assets/custom/js/login-modal.js"></script>

    <script src="http://localhost/tutor-expert/assets/custom/custom/js/enc.js"></script>

    <script>
        var oldTitle = document.title;

        function sendLogTime(data) {
            if (typeof fetch === 'function') {
                // Use Fetch API with keepalive to send data during unload
                fetch('/log-user-leaving', {
                    method: 'POST',
                    body: data,
                    keepalive: true,
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
            } else {
                // Fallback for browsers without fetch support
                const xhr = new XMLHttpRequest();
                xhr.open('POST', '/log-user-leaving', false); // Synchronous request
                xhr.setRequestHeader('Content-Type', 'application/json');
                xhr.send(data);
            }
        }
        document.addEventListener("visibilitychange", () => {
            if (document.hidden) {
                document.title = "Closed";
                // Prepare the data to send
                const data = JSON.stringify({
                    message: 'User left the page',
                    timestamp: Date.now()
                });
                sendLogTime(data);

            } else {
                document.title = "Opened";
            }
        })
        // window.addEventListener('beforeunload', function(event) {
        //     event.returnValue = 'Are you sure you want to leave?'; // Triggers dialog
        // });

        window.addEventListener('unload', function(event) {
            // Prepare the data to send
            const data = JSON.stringify({
                message: 'User left the page',
                timestamp: Date.now()
            });
            sendLogTime(data);
        });
    </script>

    <div id="yii-debug-toolbar" data-url="/tutor-expert/debug/default/toolbar?tag=68664c80a9656" data-skip-urls="[]" style="display:none" class="yii-debug-toolbar-bottom"></div><style>#yii-debug-toolbar-logo{position:fixed;right:31px;bottom:4px}@media print{.yii-debug-toolbar{display:none !important}}.yii-debug-toolbar{font:11px Verdana, Arial, sans-serif;text-align:left;width:96px;transition:width .3s ease;z-index:1000000}.yii-debug-toolbar.yii-debug-toolbar_active:not(.yii-debug-toolbar_animating) .yii-debug-toolbar__bar{overflow:visible;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.yii-debug-toolbar.yii-debug-toolbar_iframe_active:not(.yii-debug-toolbar_animating) .yii-debug-toolbar__resize-handle{display:block;height:4px;cursor:ns-resize;margin-bottom:0;z-index:1000001;position:absolute;left:0;right:0}.yii-debug-toolbar:not(.yii-debug-toolbar_active) .yii-debug-toolbar__bar,.yii-debug-toolbar.yii-debug-toolbar_animating .yii-debug-toolbar__bar{height:40px}.yii-debug-toolbar_active{width:100%}.yii-debug-toolbar_active .yii-debug-toolbar__toggle-icon{-webkit-transform:rotate(0);transform:rotate(0)}.yii-debug-toolbar_position_top{margin:0 0 20px 0;width:100%}.yii-debug-toolbar_position_bottom{position:fixed;right:0;bottom:0;margin:0}.yii-debug-toolbar__bar{position:relative;padding:0;font:11px Verdana, Arial, sans-serif;text-align:left;overflow:hidden;box-sizing:content-box;display:flex;flex-wrap:wrap;background:#fff;background:-moz-linear-gradient(top, #fff 0%, #f7f7f7 100%);background:-webkit-linear-gradient(top, #fff 0%, #f7f7f7 100%);background:linear-gradient(to bottom, #fff 0%, #f7f7f7 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#ffffff', endColorstr='#f7f7f7', GradientType=0);border:1px solid rgba(0,0,0,0.11);direction:ltr}.yii-debug-toolbar__bar::after{content:'';display:table;clear:both}.yii-debug-toolbar__view{height:0;overflow:hidden;background:white}.yii-debug-toolbar__view iframe{margin:0;padding:10px 0 0;height:100%;width:100%;border:0}.yii-debug-toolbar_iframe_active .yii-debug-toolbar__view{height:100%}.yii-debug-toolbar_iframe_active .yii-debug-toolbar__toggle-icon{-webkit-transform:rotate(90deg);transform:rotate(90deg)}.yii-debug-toolbar_iframe_active .yii-debug-toolbar__external{display:block}.yii-debug-toolbar_iframe_animating .yii-debug-toolbar__view{transition:height .3s ease}.yii-debug-toolbar__block{margin:0;border-right:1px solid rgba(0,0,0,0.11);border-bottom:1px solid rgba(0,0,0,0.11);padding:4px 8px;line-height:32px;white-space:nowrap}@media (max-width: 767.98px){.yii-debug-toolbar__block{flex-grow:1;text-align:center}}.yii-debug-toolbar__block a{display:inline-block;text-decoration:none;color:black}.yii-debug-toolbar__block img{vertical-align:middle;width:30px;height:30px}.yii-debug-toolbar__block_active,.yii-debug-toolbar__ajax:hover{background:#f7f7f7;background:-moz-linear-gradient(top, #f7f7f7 0%, #e0e0e0 100%);background:-webkit-linear-gradient(top, #f7f7f7 0%, #e0e0e0 100%);background:linear-gradient(to bottom, #f7f7f7 0%, #e0e0e0 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#f7f7f7', endColorstr='#e0e0e0', GradientType=0)}.yii-debug-toolbar__label{display:inline-block;padding:2px 4px;font-size:12px;font-weight:normal;line-height:14px;white-space:nowrap;vertical-align:middle;max-width:100px;overflow-x:hidden;text-overflow:ellipsis;color:#ffffff;text-shadow:0 -1px 0 rgba(0,0,0,0.25);background-color:#737373;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px}.yii-debug-toolbar__label:empty{display:none}a.yii-debug-toolbar__label:hover,a.yii-debug-toolbar__label:focus{color:#ffffff;text-decoration:none;cursor:pointer}.yii-debug-toolbar__label_important,.yii-debug-toolbar__label_error{background-color:#b94a48}.yii-debug-toolbar__label_important[href]{background-color:#953b39}.yii-debug-toolbar__label_warning,.yii-debug-toolbar__badge_warning{background-color:#f89406}.yii-debug-toolbar__label_warning[href]{background-color:#c67605}.yii-debug-toolbar__label_success{background-color:#217822}.yii-debug-toolbar__label_success[href]{background-color:#356635}.yii-debug-toolbar__label_info{background-color:#0b72b8}.yii-debug-toolbar__label_info[href]{background-color:#2d6987}.yii-debug-toolbar__label_inverse,.yii-debug-toolbar__badge_inverse{background-color:#333333}.yii-debug-toolbar__label_inverse[href],.yii-debug-toolbar__badge_inverse[href]{background-color:#1a1a1a}.yii-debug-toolbar__title{background:#f7f7f7;background:-moz-linear-gradient(top, #f7f7f7 0%, #e0e0e0 100%);background:-webkit-linear-gradient(top, #f7f7f7 0%, #e0e0e0 100%);background:linear-gradient(to bottom, #f7f7f7 0%, #e0e0e0 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#f7f7f7', endColorstr='#e0e0e0', GradientType=0)}.yii-debug-toolbar__block_last{width:80px;height:40px;float:left}.yii-debug-toolbar__toggle,.yii-debug-toolbar__external{cursor:pointer;position:absolute;width:30px;height:30px;font-size:25px;font-weight:100;line-height:28px;color:#ffffff;text-align:center;opacity:0.5;filter:alpha(opacity=50);transition:opacity .3s ease}.yii-debug-toolbar__toggle:hover,.yii-debug-toolbar__toggle:focus,.yii-debug-toolbar__external:hover,.yii-debug-toolbar__external:focus{color:#ffffff;text-decoration:none;opacity:0.9;filter:alpha(opacity=90)}.yii-debug-toolbar__toggle-icon,.yii-debug-toolbar__external-icon{display:inline-block;background-position:50% 50%;background-repeat:no-repeat}.yii-debug-toolbar__toggle{right:10px;bottom:4px}.yii-debug-toolbar__toggle-icon{padding:7px 0;width:10px;height:16px;background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNSIgaGVpZ2h0PSIxNSIgdmlld0JveD0iMCAwIDUwIDUwIj48cGF0aCBmaWxsPSIjNDQ0IiBkPSJNMTUuNTYzIDQwLjgzNmEuOTk3Ljk5NyAwIDAgMCAxLjQxNCAwbDE1LTE1YTEgMSAwIDAgMCAwLTEuNDE0bC0xNS0xNWExIDEgMCAwIDAtMS40MTQgMS40MTRMMjkuODU2IDI1LjEzIDE1LjU2MyAzOS40MmExIDEgMCAwIDAgMCAxLjQxNHoiLz48L3N2Zz4=");transition:-webkit-transform .3s ease-out;transition:transform .3s ease-out;-webkit-transform:rotate(180deg);transform:rotate(180deg)}.yii-debug-toolbar__external{display:none;right:50px;bottom:4px}.yii-debug-toolbar__external-icon{padding:8px 0;width:14px;height:14px;background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNSIgaGVpZ2h0PSIxNSIgdmlld0JveD0iMCAwIDUwIDUwIj48cGF0aCBmaWxsPSIjNDQ0IiBkPSJNMzkuNjQyIDkuNzIyYTEuMDEgMS4wMSAwIDAgMC0uMzgyLS4wNzdIMjguMTAzYTEgMSAwIDAgMCAwIDJoOC43NDNMMjEuNyAyNi43OWExIDEgMCAwIDAgMS40MTQgMS40MTVMMzguMjYgMTMuMDZ2OC43NDNhMSAxIDAgMCAwIDIgMFYxMC42NDZhMS4wMDUgMS4wMDUgMCAwIDAtLjYxOC0uOTI0eiIvPjxwYXRoIGQ9Ik0zOS4yNiAyNy45ODVhMSAxIDAgMCAwLTEgMXYxMC42NmgtMjh2LTI4aDEwLjY4M2ExIDEgMCAwIDAgMC0ySDkuMjZhMSAxIDAgMCAwLTEgMXYzMGExIDEgMCAwIDAgMSAxaDMwYTEgMSAwIDAgMCAxLTF2LTExLjY2YTEgMSAwIDAgMC0xLTF6Ii8+PC9zdmc+")}.yii-debug-toolbar__switch-icon{margin-left:10px;padding:5px 10px;width:18px;height:18px;background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgdmlld0JveD0iMCAwIDUwIDUwIiB2ZXJzaW9uPSIxLjEiPjxwYXRoIGQ9Im00MS4xIDIzYy0wLjYgMC0xIDAuNC0xIDF2MTAuN2wtMjUuNi0wLjFjMCAwIDAtMiAwLTIuOCAwLTAuOC0wLjctMS0xLTAuNmwtMy41IDMuNWMtMC42IDAuNi0wLjYgMS4zIDAgMmwzLjQgMy40YzAuNCAwLjQgMS4xIDAuMiAxLTAuNmwwLTIuOWMwIDAgMjAuOCAwLjEgMjYuNiAwIDAuNiAwIDEtMC40IDEtMXYtMTEuN2MwLTAuNi0wLjQtMS0xLTF6TTkgMjYuOSA5IDI2LjkgOSAyNi45IDkgMjYuOSIvPjxwYXRoIGQ9Im05IDI2LjljMC42IDAgMS0wLjQgMS0xdi0xMC43bDI1LjYgMC4xYzAgMCAwIDIgMCAyLjggMCAwLjggMC43IDEgMSAwLjZsMy41LTMuNWMwLjYtMC42IDAuNi0xLjMgMC0ybC0zLjQtMy40Yy0wLjQtMC40LTEuMS0wLjItMSAwLjZsMCAyLjljMCAwLTIwLjgtMC4xLTI2LjYgMC0wLjYgMC0xIDAuNC0xIDF2MTEuN2MwIDAuNiAwLjQgMSAxIDF6Ii8+PC9zdmc+")}.yii-debug-toolbar__ajax{position:relative}.yii-debug-toolbar__ajax:hover .yii-debug-toolbar__ajax_info,.yii-debug-toolbar__ajax:focus .yii-debug-toolbar__ajax_info{visibility:visible}.yii-debug-toolbar__ajax a{color:#337ab7}.yii-debug-toolbar__ajax table{width:100%;table-layout:auto;border-spacing:0;border-collapse:collapse}.yii-debug-toolbar__ajax table td{padding:4px;font-size:12px;line-height:normal;vertical-align:top;border-top:1px solid #ddd}.yii-debug-toolbar__ajax table th{padding:4px;font-size:11px;line-height:normal;vertical-align:bottom;border-bottom:2px solid #ddd}.yii-debug-toolbar__ajax_info{visibility:hidden;transition:visibility .2s linear;background-color:white;box-shadow:inset 0 -10px 10px -10px #e1e1e1;position:absolute;bottom:40px;left:-1px;padding:10px;max-width:480px;max-height:480px;word-wrap:break-word;overflow:hidden;overflow-y:auto;box-sizing:border-box;border:1px solid rgba(0,0,0,0.11);z-index:1000001}.yii-debug-toolbar__ajax_request_status{color:white;padding:2px 5px}.yii-debug-toolbar__ajax_request_url{max-width:170px;overflow:hidden;text-overflow:ellipsis}
</style><script>(function () {
    'use strict';

    var findToolbar = function () {
            return document.querySelector('#yii-debug-toolbar');
        },
        ajax = function (url, settings) {
            var xhr = window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject('Microsoft.XMLHTTP');
            settings = settings || {};
            xhr.open(settings.method || 'GET', url, true);
            xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');
            xhr.setRequestHeader('Accept', 'text/html');
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4) {
                    if (xhr.status === 200 && settings.success) {
                        settings.success(xhr);
                    } else if (xhr.status !== 200 && settings.error) {
                        settings.error(xhr);
                    }
                }
            };
            xhr.send(settings.data || '');
        },
        url,
        div,
        toolbarEl = findToolbar(),
        toolbarAnimatingClass = 'yii-debug-toolbar_animating',
        barSelector = '.yii-debug-toolbar__bar',
        viewSelector = '.yii-debug-toolbar__view',
        blockSelector = '.yii-debug-toolbar__block',
        toggleSelector = '.yii-debug-toolbar__toggle',
        externalSelector = '.yii-debug-toolbar__external',

        CACHE_KEY = 'yii-debug-toolbar',
        ACTIVE_STATE = 'active',

        animationTime = 300,

        activeClass = 'yii-debug-toolbar_active',
        iframeActiveClass = 'yii-debug-toolbar_iframe_active',
        iframeAnimatingClass = 'yii-debug-toolbar_iframe_animating',
        titleClass = 'yii-debug-toolbar__title',
        blockClass = 'yii-debug-toolbar__block',
        ignoreClickClass = 'yii-debug-toolbar__ignore_click',
        blockActiveClass = 'yii-debug-toolbar__block_active',
        requestStack = [];

    if (toolbarEl) {
        url = toolbarEl.getAttribute('data-url');

        ajax(url, {
            success: function (xhr) {
                div = document.createElement('div');
                div.innerHTML = xhr.responseText;

                toolbarEl.parentNode && toolbarEl.parentNode.replaceChild(div, toolbarEl);

                showToolbar(findToolbar());

                var event;
                if (typeof(Event) === 'function') {
                    event = new Event('yii.debug.toolbar_attached', {'bubbles': true});
                } else {
                    event = document.createEvent('Event');
                    event.initEvent('yii.debug.toolbar_attached', true, true);
                }

                div.dispatchEvent(event);
            },
            error: function (xhr) {
                toolbarEl.innerText = xhr.responseText;
            }
        });
    }

    function showToolbar(toolbarEl) {
        var barEl = toolbarEl.querySelector(barSelector),
            viewEl = toolbarEl.querySelector(viewSelector),
            toggleEl = toolbarEl.querySelector(toggleSelector),
            externalEl = toolbarEl.querySelector(externalSelector),
            blockEls = barEl.querySelectorAll(blockSelector),
            blockLinksEls = document.querySelectorAll(blockSelector + ':not(.' + titleClass + ') a'),
            iframeEl = viewEl.querySelector('iframe'),
            iframeHeight = function () {
                return (window.innerHeight * (toolbarEl.dataset.height / 100) - barEl.clientHeight) + 'px';
            },
            isIframeActive = function () {
                return toolbarEl.classList.contains(iframeActiveClass);
            },
            resizeIframe = function(mouse) {
                var availableHeight = window.innerHeight - barEl.clientHeight;
                viewEl.style.height = Math.min(availableHeight, availableHeight - mouse.y) + "px";
            },
            showIframe = function (href) {
                toolbarEl.classList.add(iframeAnimatingClass);
                toolbarEl.classList.add(iframeActiveClass);

                iframeEl.src = externalEl.href = href;
                iframeEl.removeAttribute('tabindex');

                viewEl.style.height = iframeHeight();
                setTimeout(function () {
                    toolbarEl.classList.remove(iframeAnimatingClass);
                }, animationTime);
            },
            hideIframe = function () {
                toolbarEl.classList.add(iframeAnimatingClass);
                toolbarEl.classList.remove(iframeActiveClass);
                iframeEl.setAttribute("tabindex", "-1");
                removeActiveBlocksCls();

                externalEl.href = '#';
                viewEl.style.height = '';
                setTimeout(function () {
                    toolbarEl.classList.remove(iframeAnimatingClass);
                }, animationTime);
            },
            removeActiveBlocksCls = function () {
                [].forEach.call(blockEls, function (el) {
                    el.classList.remove(blockActiveClass);
                });
            },
            toggleToolbarClass = function (className) {
                toolbarEl.classList.add(toolbarAnimatingClass);
                if (toolbarEl.classList.contains(className)) {
                    toolbarEl.classList.remove(className);
                    [].forEach.call(blockLinksEls, function (el) {
                        el.setAttribute('tabindex', "-1");
                    });
                } else {
                    [].forEach.call(blockLinksEls, function (el) {
                        el.removeAttribute('tabindex');
                    });
                    toolbarEl.classList.add(className);
                }
                setTimeout(function () {
                    toolbarEl.classList.remove(toolbarAnimatingClass);
                }, animationTime);
            },
            toggleStorageState = function (key, value) {
                if (window.localStorage) {
                    var item = localStorage.getItem(key);

                    if (item) {
                        localStorage.removeItem(key);
                    } else {
                        localStorage.setItem(key, value);
                    }
                }
            },
            restoreStorageState = function (key) {
                if (window.localStorage) {
                    return localStorage.getItem(key);
                }
            },
            togglePosition = function () {
                if (isIframeActive()) {
                    hideIframe();
                } else {
                    toggleToolbarClass(activeClass);
                    toggleStorageState(CACHE_KEY, ACTIVE_STATE);
                }
            };

        if (restoreStorageState(CACHE_KEY) === ACTIVE_STATE) {
            var transition = toolbarEl.style.transition;
            toolbarEl.style.transition = 'none';
            toolbarEl.classList.add(activeClass);
            setTimeout(function () {
                toolbarEl.style.transition = transition;
            }, animationTime);
        } else {
            [].forEach.call(blockLinksEls, function (el) {
                el.setAttribute('tabindex', "-1");
            });
        }

        toolbarEl.style.display = 'block';

        window.onresize = function () {
            if (toolbarEl.classList.contains(iframeActiveClass)) {
                viewEl.style.height = iframeHeight();
            }
        };

        toolbarEl.addEventListener("mousedown", function(e) {
            if (isIframeActive() && (e.y - toolbarEl.offsetTop < 4 /* 4px click zone */)) {
                document.addEventListener("mousemove", resizeIframe, false);
            }
        }, false);

        document.addEventListener("mouseup", function(){
            if (isIframeActive()) {
                document.removeEventListener("mousemove", resizeIframe, false);
            }
        }, false);

        barEl.onclick = function (e) {
            var target = e.target,
                block = findAncestor(target, blockClass);

            if (block
                && !block.classList.contains(titleClass)
                && !block.classList.contains(ignoreClickClass)
                && e.which !== 2 && !e.ctrlKey // not mouse wheel and not ctrl+click
            ) {
                while (target !== this) {
                    if (target.href) {
                        removeActiveBlocksCls();
                        block.classList.add(blockActiveClass);
                        showIframe(target.href);
                    }
                    target = target.parentNode;
                }

                e.preventDefault();
            }
        };

        toggleEl.onclick = togglePosition;
    }

    function findAncestor(el, cls) {
        while ((el = el.parentElement) && !el.classList.contains(cls)) ;
        return el;
    }

    function renderAjaxRequests() {
        var requestCounter = document.getElementsByClassName('yii-debug-toolbar__ajax_counter');
        if (!requestCounter.length) {
            return;
        }
        var ajaxToolbarPanel = document.querySelector('.yii-debug-toolbar__ajax');
        var tbodies = document.getElementsByClassName('yii-debug-toolbar__ajax_requests');
        var state = 'ok';
        if (tbodies.length) {
            var tbody = tbodies[0];
            var rows = document.createDocumentFragment();
            if (requestStack.length) {
                var firstItem = requestStack.length > 20 ? requestStack.length - 20 : 0;
                for (var i = firstItem; i < requestStack.length; i++) {
                    var request = requestStack[i];
                    var row = document.createElement('tr');
                    rows.appendChild(row);

                    var methodCell = document.createElement('td');
                    methodCell.innerHTML = request.method;
                    row.appendChild(methodCell);

                    var statusCodeCell = document.createElement('td');
                    var statusCode = document.createElement('span');
                    if (request.statusCode < 300) {
                        statusCode.setAttribute('class', 'yii-debug-toolbar__ajax_request_status yii-debug-toolbar__label_success');
                    } else if (request.statusCode < 400) {
                        statusCode.setAttribute('class', 'yii-debug-toolbar__ajax_request_status yii-debug-toolbar__label_warning');
                    } else {
                        statusCode.setAttribute('class', 'yii-debug-toolbar__ajax_request_status yii-debug-toolbar__label_error');
                    }
                    statusCode.textContent = request.statusCode || '-';
                    statusCodeCell.appendChild(statusCode);
                    row.appendChild(statusCodeCell);

                    var pathCell = document.createElement('td');
                    pathCell.className = 'yii-debug-toolbar__ajax_request_url';
                    pathCell.innerHTML = request.url;
                    pathCell.setAttribute('title', request.url);
                    row.appendChild(pathCell);

                    var durationCell = document.createElement('td');
                    durationCell.className = 'yii-debug-toolbar__ajax_request_duration';
                    if (request.duration) {
                        durationCell.innerText = request.duration + " ms";
                    } else {
                        durationCell.innerText = '-';
                    }
                    row.appendChild(durationCell);
                    row.appendChild(document.createTextNode(' '));

                    var profilerCell = document.createElement('td');
                    if (request.profilerUrl) {
                        var profilerLink = document.createElement('a');
                        profilerLink.setAttribute('href', request.profilerUrl);
                        profilerLink.innerText = request.profile;
                        profilerCell.appendChild(profilerLink);
                    } else {
                        profilerCell.innerText = 'n/a';
                    }
                    row.appendChild(profilerCell);

                    if (request.error) {
                        if (state !== "loading" && i > requestStack.length - 4) {
                            state = 'error';
                        }
                    } else if (request.loading) {
                        state = 'loading'
                    }
                    row.className = 'yii-debug-toolbar__ajax_request';
                }
                while (tbody.firstChild) {
                    tbody.removeChild(tbody.firstChild);
                }
                tbody.appendChild(rows);
            }
            ajaxToolbarPanel.style.display = 'block';
        }
        requestCounter[0].innerText = requestStack.length;
        var className = 'yii-debug-toolbar__label yii-debug-toolbar__ajax_counter';
        if (state === 'ok') {
            className += ' yii-debug-toolbar__label_success';
        } else if (state === 'error') {
            className += ' yii-debug-toolbar__label_error';
        }
        requestCounter[0].className = className;
    }

    /**
     * Should AJAX request to be logged in debug panel
     *
     * @param requestUrl
     * @returns {boolean}
     */
    function shouldTrackRequest(requestUrl) {
        if (!toolbarEl) {
            return false;
        }
        var a = document.createElement('a');
        a.href = requestUrl;
        var skipAjaxRequestUrls = JSON.parse(toolbarEl.getAttribute('data-skip-urls'));
        if (Array.isArray(skipAjaxRequestUrls) && skipAjaxRequestUrls.length && skipAjaxRequestUrls.includes(requestUrl)) {
            return false;
        }
        return a.host === location.host;
    }

    var proxied = XMLHttpRequest.prototype.open;

    XMLHttpRequest.prototype.open = function (method, url, async, user, pass) {
        var self = this;

        if (shouldTrackRequest(url)) {
            var stackElement = {
                loading: true,
                error: false,
                url: url,
                method: method,
                start: new Date()
            };
            requestStack.push(stackElement);
            this.addEventListener('readystatechange', function () {
                if (self.readyState === 4) {
                    stackElement.duration = self.getResponseHeader('X-Debug-Duration') || new Date() - stackElement.start;
                    stackElement.loading = false;
                    stackElement.statusCode = self.status;
                    stackElement.error = self.status < 200 || self.status >= 400;
                    stackElement.profile = self.getResponseHeader('X-Debug-Tag');
                    stackElement.profilerUrl = self.getResponseHeader('X-Debug-Link');
                    renderAjaxRequests();
                }
            }, false);
            renderAjaxRequests();
        }
        proxied.apply(this, Array.prototype.slice.call(arguments));
    };

    // catch fetch AJAX requests
    if (window.fetch) {
        var originalFetch = window.fetch;

        window.fetch = function (input, init) {
            var method;
            var url;
            if (typeof input === 'string') {
                method = (init && init.method) || 'GET';
                url = input;
            } else if (window.URL && input instanceof URL) { // fix https://github.com/yiisoft/yii2-debug/issues/296
                method = (init && init.method) || 'GET';
                url = input.href;
            } else if (window.Request && input instanceof Request) {
                method = input.method;
                url = input.url;
            }
            var promise = originalFetch(input, init);

            if (shouldTrackRequest(url)) {
                var stackElement = {
                    loading: true,
                    error: false,
                    url: url,
                    method: method,
                    start: new Date()
                };
                requestStack.push(stackElement);
                promise.then(function (response) {
                    stackElement.duration = response.headers.get('X-Debug-Duration') || new Date() - stackElement.start;
                    stackElement.loading = false;
                    stackElement.statusCode = response.status;
                    stackElement.error = response.status < 200 || response.status >= 400;
                    stackElement.profile = response.headers.get('X-Debug-Tag');
                    stackElement.profilerUrl = response.headers.get('X-Debug-Link');
                    renderAjaxRequests();

                    return response;
                }).catch(function (error) {
                    stackElement.loading = false;
                    stackElement.error = true;
                    renderAjaxRequests();

                    throw error;
                });
                renderAjaxRequests();
            }

            return promise;
        };
    }

})();
</script><script src="/tutor-expert/assets/d1d54b97/jquery.js"></script>
<script src="/tutor-expert/assets/97be7745/yii.js"></script></body>

</html>
